# MySQL의 전체 구조
![img.png](김정민/전체구조.png)

MySQL 서버 = MySQL 엔진 + 스토리지 엔진  
## MySQL 엔진
- 커넥션핸들러: 클라이언트로부터의 접속, 쿼리 요청 처리
- SQL 파서: SQL 문장을 파싱 해주는 역할
- SQL 옵티마이저: SQL을 수행할 최적의 처리 경로를 생성해주는 핵심 역할
- 캐시 & 버퍼: 쿼리를 캐시해서 성능에 도움을 준다
## 스토리지 엔진
- 실제 데이터를 디스크에 저장하고 읽어오는 부분
- 스토리지 엔진은 여러 개를 동시에 사용할 수 있음.
```mysql
CREATE TABLE test(fd1 INT, fd2 INT) ENGINE = INNODB;
```
예시 코드처럼 테이블 생성시 ENGINE을 지정할 수 있다
# 스레딩 구조
![img_1.png](김정민/스레딩구조.png)
MySQL은 스레드 기반으로 작동하며 포그라운드 스레드와 백그라운드 스레드로 구분할 수 있다.

**참고 프로세스와 스레드차이**
https://velog.io/@raejoonee/%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%99%80-%EC%8A%A4%EB%A0%88%EB%93%9C%EC%9D%98-%EC%B0%A8%EC%9D%B4

**포그라운드 작업**  
사용자가 입력한 명령이 실행되어 결과가 출력될 때까지 기다리는 방식으로 처리되는 작업  
**백그라운드 작업**    
사용자가 입력한 명령이 끝나는것과 상관없이 곧바로 다른 작업을 진행할 수 있는 작업
## 포그라운드 스레드
- 사용자가 요청하는 쿼리 문장 처리
- 일반적으로 사용이 종료되면 다시 스레드 캐시로 되돌아감
- 스레드 캐시는 thread_cache_size 시스템 변수의 값만큼만 존재함
- 데이터 버퍼 캐시, 디스크나 인덱스 파일로부터 데이터를 읽어온다.
## 백그라운드 스레드
InnoDB 기준으로 백그라운드로 처리되는 스레드는 다음과 같다.
- 인서트 버퍼 병합 스레드
- 로그 기록 스레드
- InnoDB 버퍼 풀의 데이터를 디스크에 기록하는 스레드
- 데이터를 버퍼로 읽어오는 스레드
- 잠금이나 데드락을 모니터링 하는 스레드

MySQL 5.5버전 부터는 쓰기 쓰레드와 읽기 스레드의 개수를 지정할 수 있게 되었고, 이는 시스템의 환경을 고려하여 적절하게 설정 하는 것이 좋다.  
또한 InnoDB의 경우에는 쓰기 작업을 버퍼링해서 일괄 처리하는 기능을 지원하지만, MyISAM은 지원하지 않는다.

